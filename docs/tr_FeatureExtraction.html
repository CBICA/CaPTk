<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cancer Imaging Phenomics Toolkit (CaPTk): Feature Extraction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cancer Imaging Phenomics Toolkit (CaPTk)
   &#160;<span id="projectnumber">1.8.0.Alpha2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tr_FeatureExtraction.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Feature Extraction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tr_fe_defaults"></a>
Pre-Existing Parameter Configurations</h1>
<p>The Feature Extraction module ships with a set of pre-configured parameter files for 3D and 2D images (there are different extraction paradigms). The idea behind providing these configurations for users to have a template to start with and then customize the feature extraction based on their dataset(s).</p>
<p>During invocation from the CLI, the appropriate file should be passed after the <b>-p</b> parameter.</p>
<p>See the subsequent sections for details.</p>
<h2><a class="anchor" id="tr_fe_def_main"></a>
Default 3D Image Feature Extraction Parameters</h2>
<p>This is primarily targeted at brain tumor image feature extraction and users should customize it for their own dataset.</p>
<p>For a description of the parameters and related explanations, please see <b>${CaPTk_InstallDir}/data/features/1_params_default.csv</b> or <a href="https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/1_params_default.csv">https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/1_params_default.csv</a>.</p>
<h2><a class="anchor" id="tr_fe_def_lattice"></a>
Default 2D Image Feature Extraction Parameters</h2>
<p>This are primarily targeted at mammogram image feature extraction and users should customize it for their own dataset.</p>
<p>For a description of the parameters and related explanations, please see <b>${CaPTk_InstallDir}/data/features/2_params_default_lattice.csv</b> or <a href="https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/2_params_default_lattice.csv">https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/2_params_default_lattice.csv</a>.</p>
<h2><a class="anchor" id="tr_fe_customization"></a>
Customizing Parameters</h2>
<p>The user will need to pass a custom parameter file to Feature Extraction. For details on creating such a file, please see <a href="https://github.com/CBICA/CaPTk/tree/master/src/applications/FeatureExtraction#the-parameter-file">https://github.com/CBICA/CaPTk/tree/master/src/applications/FeatureExtraction#the-parameter-file</a>.</p>
<h1><a class="anchor" id="tr_fe_batch"></a>
Batch Mode</h1>
<p>An example of the list file for batch processing can be found in <b>${CaPTk_InstallDir}/share/featureExtractionBatch/batch_featureExtraction.csv</b> or <a href="https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/batchMode/batch_featureExtraction.csv">https://github.com/CBICA/CaPTk/blob/master/src/applications/FeatureExtraction/data/batchMode/batch_featureExtraction.csv</a>.</p>
<h1><a class="anchor" id="tr_fe_math"></a>
Extracted Features</h1>
<table border="1">
<tr>
<td align="center"><b>Feature Family</b> </td><td align="center"><b>Specific <br  />
 Features</b> </td><td align="center"><b>Parameter<br  />
Name</b> </td><td align="center"><b>Range</b> </td><td align="center"><b>Default</b> </td><td align="center"><b>Description, Formula and Comments</b>  </td></tr>
<tr>
<td align="center">Intensity Features<br  />
(First-Order Statistics) </td><td><ul>
<li>
Minimum </li>
<li>
Maximum </li>
<li>
Mean </li>
<li>
Standard Deviation </li>
<li>
Variance </li>
<li>
Skewness </li>
<li>
Kurtosis </li>
</ul>
</td><td>N.A. </td><td>N.A. </td><td>N.A. </td><td><ul>
<li>
Minimum Intensity = \( Min (I_{k}). \) where \( I_{k} \) is the intensity of pixel or voxel at index k. </li>
<li>
Maximum Intensity = \( Max (I_{k}). \) where \( I_{k} \) is the intensity of pixel or voxel at index k. </li>
<li>
Mean= \( \frac{\sum(X_{i})}{N} \) where N is the number of voxels/pixels. </li>
<li>
Standard Deviation = \( \sqrt{\frac{\sum(X-\mu)^{2}}{N}}\) where \(\mu\) is the mean of the data. </li>
<li>
Variance = \( \frac{\sum(X-\mu)^{2}}{N} \) where \(\mu\) is the mean intensity. </li>
<li>
Skewness = \( \frac{\sum_{i=1}^{N}(X_{i} - \bar{X})^{3}/N} {s^{3}} \) where \(\bar{X}\) is the mean, s is the standard deviation and N is the number of pixels/voxels. </li>
<li>
Kurtosis = \( \frac{\sum_{i=1}^{N}(X_{i} - \bar{X})^{4}/N}{s^{4}} \) where \(\bar{X}\) is the mean, s is the standard deviation and N is the number of pixels/voxels. </li>
</ul>
<br  />
 All features in this family are extracted from the raw intensities.   </td></tr>
<tr>
<td align="center">Histogram<br  />
-based </td><td><ul>
<li>
Bin Frequency </li>
</ul>
</td><td>Bins </td><td>N.A. </td><td>10 </td><td><ul>
<li>
Uses number of bins as input and the number of pixels in each bin would be the output. </li>
</ul>
All features in this family are extracted from the discretized intensities.  </td></tr>
<tr>
<td align="center">Volumetric </td><td><ul>
<li>
Volume/Area</li>
</ul>
</td><td>Dimensions <br  />
Axis </td><td>2D:3D <br  />
x,y,z </td><td>3D <br  />
z </td><td><ul>
<li>
Volume/Area (depending on image dimension) and number of voxels/pixels in the ROI. </li>
</ul>
</td></tr>
<tr>
<td align="center">Morphologic </td><td><ul>
<li>
Elongation </li>
<li>
Perimeter <br  />
 </li>
<li>
Roundness </li>
<li>
Eccentricity </li>
<li>
Ellipse Diameter </li>
<li>
Equivalent Spherical Radius </li>
</ul>
</td><td>Dimensions <br  />
Axis </td><td>2D:3D <br  />
x,y,z </td><td>3D <br  />
z </td><td><ul>
<li>
Elongation = \( \sqrt{\frac{i_{2}}{i_{1}}} \) where \(i_{n}\) are the second moments of particle around its principal axes. </li>
<li>
Perimeter = \( 2 \pi r \) where r is the radius of the circle enclosing the shape. </li>
<li>
Roundness = \( As/Ac = (Area of a shape)/(Area of circle) \) where circle has the same perimeter. </li>
<li>
Eccentricity = \( \sqrt{1 - \frac{a*b}{c^{2}}} \) where c is the longest semi-principal axis of an ellipsoid fitted on an ROI, and a and b are the 2nd and 3rd longest semi-principal axes of the ellipsoid. </li>
</ul>
</td></tr>
<tr>
<td align="center">Local Binary<br  />
Pattern (LBP) </td><td></td><td>Radius <br  />
Neighborhood </td><td>N.A. <br  />
2:4:8 </td><td>N.A. <br  />
8 </td><td><ul>
<li>
The LBP codes are computed using N sampling points on a circle of radius R and using mapping table. </li>
</ul>
</td></tr>
<tr>
<td align="center">Grey Level<br  />
Co-occurrence<br  />
Matrix<br  />
 (GLCM) </td><td><ul>
<li>
Energy (Angular Second Moment) </li>
<li>
Contrast (Inertia) </li>
<li>
Joint Entropy </li>
<li>
Homogeneity (Inverse Difference Moment) </li>
<li>
Correlation </li>
<li>
Variance </li>
<li>
SumAverage </li>
<li>
Variance </li>
<li>
Auto<br  />
Correlation <br  />
 </li>
</ul>
</td><td>Bins <br  />
<br  />
Radius <br  />
<br  />
Dimensions <br  />
<br  />
Offset <br  />
<br  />
Axis </td><td>N.A. <br  />
<br  />
N.A. <br  />
<br  />
2D:3D <br  />
<br  />
Individual/Average/Combined<br  />
<br  />
x,y,z </td><td>10 <br  />
<br  />
13 <br  />
<br  />
2 <br  />
<br  />
3D <br  />
<br  />
Average <br  />
<br  />
z </td><td>For a given image, a Grey Level Co-occurrence Matrix is created and \( g(i,j) \) represents an element in matrix <ul>
<li>
Energy = \( \sum_{i,j}g(i, j)^2 \) </li>
<li>
Contrast = \( \sum_{i,j}(i - j)^2g(i, j) \) </li>
<li>
Joint Entropy = \( -\sum_{i,j}g(i, j) \log_2 g(i, j) \) </li>
<li>
Homogeneity = \( \sum_{i,j}\frac{1}{1 + (i - j)^2}g(i, j) \) </li>
<li>
Correlation = \( \sum_{i,j}\frac{(i - \mu)(j - \mu)g(i, j)}{\sigma^2} \) </li>
<li>
Sum Average = \( \sum_{i,j}i \cdot g(i, j) = \sum_{i,j}j \cdot g(i, j)\)(due to matrix symmetry) </li>
<li>
Variance = \( \sum_{i,j}(i - \mu)^2 \cdot g(i, j) = \sum_{i,j}(j - \mu)^2 \cdot g(i, j)\) (due to matrix symmetry) </li>
<li>
AutoCorrelation = \(\frac{\sum_{i,j}(i, j) g(i, j)-\mu_t^2}{\sigma_t^2}\) where \(\mu_t\) and \(\sigma_t\) are the mean and standard deviation of the row (or column, due to symmetry) sums. </li>
</ul>
All features are estimated within the ROI in an image, considering 26-connected neighboring voxels in the 3D volume. <b>Note</b> that the creation of the GLCM and its corresponding aforementioned features for all offsets are calculated using an existing ITK filter. The <b>Individual</b> option gives features for each individual offset, <b>Average</b> estimates the average across all offsets and assigns a single value for each feature and <b>Combined</b> combines the GLCM matrices generated across offsets and calculates a single set of features from this matrix.  </td></tr>
<tr>
<td align="center">Grey Level<br  />
Run-Length<br  />
Matrix<br  />
 (GLRLM) </td><td><ul>
<li>
SRE </li>
<li>
LRE </li>
<li>
GLN </li>
<li>
RLN </li>
<li>
LGRE </li>
<li>
HGRE </li>
<li>
SRLGE </li>
<li>
SRHGE </li>
<li>
LRLGE </li>
<li>
LRHGE <br  />
 </li>
</ul>
</td><td>Bins <br  />
<br  />
Radius <br  />
<br  />
Dimensions <br  />
<br  />
Axis <br  />
<br  />
Offset </td><td>N.A. <br  />
<br  />
N.A. <br  />
<br  />
2D:3D <br  />
<br  />
x,y,z <br  />
<br  />
Individual/Average/Combined </td><td>10 <br  />
<br  />
13 <br  />
<br  />
2 <br  />
<br  />
3D <br  />
<br  />
z <br  />
<br  />
Average <br  />
<br  />
1 </td><td>For a given image, a run-length matrix \( P(i; j)\) is defined as the number of runs with pixels of gray level i and run length j. Please note that some features are only extracted in DebugMode (by using the "-d" parameter from the command line); these defines features that are mathematically formulated in previous published material but not completely aligned with The Image Biomarker Standardisation Initiative. <ul>
<li>
[COMPLETE MODE] Short Run Emphasis (SRE) = \( \frac{1}{n_r}\sum_{i,j}^{N}\frac{p(i,j)}{j^2} \) </li>
<li>
[COMPLETE MODE] Long Run Emphasis (LRE) = \( \frac{1}{n_r}\sum_{j}^{N}p(i,j) \cdot j^2\) </li>
<li>
[COMPLETE MODE] Grey Level Non-uniformity (GLN) = \( \frac{1}{n_r}\sum_{i}^{M}\Big(\sum_{j}^{N}p(i,j) \Big)^2 \) </li>
<li>
[COMPLETE MODE] Run Length Non-uniformity (RLN) = \( \frac{1}{n_r}\sum_{j}^{N}\Big(\sum_{i}^{M}p(i,j) \Big)^2 \) <br  />
 </li>
<li>
Low Grey-Level Run Emphasis (LGRE)= \( \frac{1}{n_r}\sum_{i}^{M}\frac{p_g(i)}{i^2} \) </li>
<li>
High Grey-Level Run Emphasis (HGRE)= \( \frac{1}{n_r}\sum_{i}^{M}p_g(i) \cdot i^2 \) </li>
<li>
Short Run Low Grey-Level Emphasis (SRLGE)= \(\frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j)}{i^2 \cdot j^2} \) </li>
<li>
Short Run High Grey-Level Emphasis (SRLGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j) \cdot i^2 }{j^2}\) </li>
<li>
[COMPLETE MODE] Long Run Low Grey-Level Emphasis (LRLGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j) \cdot j^2 }{i^2} \) </li>
<li>
[COMPLETE MODE] Long Run High Grey-Level Emphasis (LRHGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}p(i,j) \cdot i^2 \cdot j^2 \) </li>
</ul>
All features are estimated within the ROI in an image, considering 26-connected neighboring voxels in the 3D volume. <b>Note</b> that the creation of the GLRLM and its corresponding aforementioned features for all offsets are calculated using an existing ITK filter. The <b>Individual</b> option gives features for each individual offset, <b>Average</b> estimates the average across all offsets and assigns a single value for each feature and <b>Combined</b> combines the GLRLM matrices generated across offsets and calculates a single set of features from this matrix.  </td></tr>
<tr>
<td align="center">Neighborhood<br  />
Grey-Tone<br  />
Difference<br  />
Matrix<br  />
 (NGTDM) </td><td><ul>
<li>
Coarseness </li>
<li>
Contrast </li>
<li>
Busyness </li>
<li>
Complexity </li>
<li>
Strength </li>
</ul>
</td><td>Bins <br  />
<br  />
Dimensions <br  />
<br  />
Axis </td><td>N.A. <br  />
<br  />
2D:3D <br  />
<br  />
x,y,z </td><td>10 <br  />
<br  />
13 <br  />
<br  />
3D <br  />
<br  />
N.A. <br  />
<br  />
1 </td><td><ul>
<li>
Coarseness = \( \Big[ \epsilon + \sum_{i=0}^{G_{k}} p_{i}s(i) \Big]\) </li>
<li>
Contrast = \( \Big[\frac{1}{N_{s}(N_{s}-1)}\sum_{i}^{G_{k}}\sum_{j}^{G_{k}}p_{i}p_{j}(i-j)^2\Big]\Big[\frac{1}{n^2}\sum_{i}^{G_{k}}s(i)\Big] \) </li>
<li>
Busyness = \( \Big[\sum_{i}^{G_{k}}p_{i}s(i)\Big]\Big/ \Big[\sum_{i}^{G_{k}}\sum_{j}^{G_{k}}i p_{i} - j p_{j}\Big] \) </li>
<li>
Complexity = \( \sum_{i}^{G_{k}}\sum_{j}^{G_{k}} \Big[ \frac{(|i-j|)}{(n^{2}(p_{i}+p_{j}))} \Big] \Big[ p_{i}s(i)+p_{j}s(j) \Big]\) </li>
<li>
Strength = \( \Big[\sum_{i}^{G_{k}}\sum_{j}^{G_{k}}(p_{i}+p_{j})(i-j)^{2}\Big]/\Big[\epsilon + \sum_{i}^{G_{k}} s(i)\Big]\) </li>
</ul>
Where \(p_{i}\) is the probability of occurrence of a voxel of intensity i and \(s(i)\) represents the NGTDM value of intensity i calculated as: \( \sum │i - Ai│\). Ai indicates the average intensity of the surrounding voxels without including the central voxel. <br  />
  </td></tr>
<tr>
<td align="center">Grey Level<br  />
Size-Zone<br  />
Matrix<br  />
 (GLSZM) </td><td><ul>
<li>
SZE </li>
<li>
LZE </li>
<li>
GLN </li>
<li>
ZSN </li>
<li>
ZP </li>
<li>
LGZE </li>
<li>
HGZE </li>
<li>
SZLGE </li>
<li>
SZHGE </li>
<li>
LZLGE </li>
<li>
LZHGE </li>
<li>
GLV </li>
<li>
ZLV <br  />
 </li>
</ul>
</td><td>Bins <br  />
<br  />
Radius <br  />
<br  />
Dimensions <br  />
<br  />
Axis </td><td>N.A. <br  />
<br  />
N.A. <br  />
<br  />
2D:3D <br  />
<br  />
x,y,z </td><td>10 <br  />
<br  />
13 <br  />
<br  />
2 <br  />
<br  />
3D <br  />
<br  />
z <br  />
<br  />
4 </td><td>For a given image, a run-length matrix \( P(i; j)\) is defined as the number of runs with pixels of gray level i and run length j. <ul>
<li>
Small Zone Emphasis (SZE) = \( \frac{1}{n_r}\sum_{i,j}^{N}\frac{p(i,j)}{j^2} \) </li>
<li>
Large Zone Emphasis(LZE) = \( \frac{1}{n_r}\sum_{j}^{N}p(i,j) \cdot j^2\) </li>
<li>
Gray-Level Non-uniformity (GLN) = \( \frac{1}{n_r}\sum_{i}^{M}\Big(\sum_{j}^{N}p(i,j) \Big)^2 \) </li>
<li>
Zone-Size Non-uniformity (ZSN) = \( \frac{1}{n_r}\sum_{j}^{N}\Big(\sum_{i}^{M}p(i,j) \Big)^2 \) <br  />
 </li>
<li>
Zone Percentage (ZP) = \( \frac{n_{r}}{n_p} \) where \( n_r \) is the total number of runs and \( n_p \) is the number of pixels in the image. </li>
<li>
Low Grey-Level Zone Emphasis (LGZE)= \( \frac{1}{n_r}\sum_{i}^{M}\frac{p_g(i)}{i^2} \) </li>
<li>
High Grey-Level Zone Emphasis (HGZE)= \( \frac{1}{n_r}\sum_{i}^{M}p_g(i) \cdot i^2 \) </li>
<li>
Short Zone Low Grey-Level Emphasis (SZLGE)= \(\frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j)}{i^2 \cdot j^2} \) </li>
<li>
Short Zone High Grey-Level Emphasis (SZLGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j) \cdot i^2 }{j^2}\) </li>
<li>
Long Zone Low Grey-Level Emphasis (LZLGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}\frac{p(i,j) \cdot j^2 }{i^2} \) </li>
<li>
Long Zone High Grey-Level Emphasis (LZHGE) = \( \frac{1}{n_r}\sum_{i}^{M}\sum_{j}^{N}p(i,j) \cdot i^2 \cdot j^2 \) </li>
</ul>
All features are estimated within the ROI in an image, considering 26-connected neighboring voxels in the 3D volume.  </td></tr>
<tr>
<td align="center">Lattice<br  />
-based </td><td><ul>
<li>
Selected features </li>
<li>
Feature Maps </li>
</ul>
</td><td><ul>
<li>
FullImage </li>
<li>
Window </li>
<li>
Step </li>
<li>
Boundary </li>
<li>
PatchBoundary </li>
</ul>
</td><td><ul>
<li>
0-1 </li>
<li>
(mm)0:ImageSize </li>
<li>
(mm)0:ImageSize </li>
<li>
NoPadding:ZeroPadding </li>
<li>
Full:ROI:None </li>
</ul>
</td><td><ul>
<li>
0 </li>
<li>
6.3 </li>
<li>
6.3 </li>
<li>
NoPadding </li>
<li>
Full </li>
</ul>
</td><td>Please see <b>${CaPTk_InstallDir}/data/features/2_params_default_lattice.csv</b> for detailed descriptions.   </td></tr>
</table>
<p>Detailed explanation of the mathematics and other details can be found in the <a href="https://ibsi.readthedocs.io/en/latest/">Image Biomarker Standardization Initiative (IBSI) page</a>.</p>
<p>The parameterization of the <b>lattice-based strategy</b> for feature extraction is defined by:</p><ul>
<li>The grid spacing representing the distance between consecutive lattice points (Default: 6.3mm).</li>
<li>The size of the local region centered at each lattice point (Default: 6.3mm). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<class="footer">
					Generated by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a>.
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
